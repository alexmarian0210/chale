<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Pedido de Caf√© da Manh√£</title>
    <style>
        /* Estilos do Formul√°rio */
        body { font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; background-color: #f4f1ea; display: flex; justify-content: center; align-items: center; min-height: 100vh; margin: 0; padding: 20px; box-sizing: border-box; }
        .form-container { background-color: white; padding: 2rem; border-radius: 15px; box-shadow: 0 4px 15px rgba(0,0,0,0.1); max-width: 500px; width: 100%; border-top: 5px solid #d4a373; }
        h1 { text-align: center; color: #6f4e37; margin-bottom: 1.5rem; }
        fieldset { border: 1px solid #ddd; border-radius: 8px; margin-bottom: 1.5rem; padding: 1rem; }
        legend { font-weight: bold; color: #d4a373; padding: 0 10px; text-transform: uppercase; font-size: 0.9rem; }
        label { display: block; margin-bottom: 8px; cursor: pointer; transition: color 0.2s; }
        label:hover { color: #d4a373; }
        label.disabled { color: #ccc; cursor: not-allowed; }
        .input-text { width: 100%; padding: 10px; margin-top: 5px; border: 1px solid #ccc; border-radius: 6px; box-sizing: border-box; font-size: 1rem; color: #555; }
        .input-text:focus { outline: none; border-color: #d4a373; box-shadow: 0 0 5px rgba(212, 163, 115, 0.5); }
        input[type="radio"], input[type="checkbox"] { margin-right: 10px; accent-color: #d4a373; }
        button { width: 100%; padding: 12px; background-color: #6f4e37; color: white; border: none; border-radius: 8px; font-size: 1.1rem; cursor: pointer; transition: background-color 0.3s; }
        button:hover { background-color: #5a3e2b; }
        .loading { opacity: 0.7; cursor: wait; }
    </style>
</head>
<body>

<div class="form-container">
    <h1>‚òï Monte seu Caf√©</h1>
    
    <form id="breakfastForm">
        
        <fieldset>
            <legend>Seus Dados</legend>
            <label>
                Nome Completo:
                <input type="text" id="nomeCliente" name="nome" class="input-text" placeholder="Digite seu nome" required>
            </label>
            <label>
                Data do Pedido:
                <input type="date" name="data" class="input-text" required>
            </label>
        </fieldset>

        <fieldset>
            <legend>Escolha 1 tipo de P√£o</legend>
            <label><input type="radio" name="pao" value="frances" required> P√£o Franc√™s</label>
            <label><input type="radio" name="pao" value="queijo"> P√£o de Queijo</label>
            <label><input type="radio" name="pao" value="integral"> P√£o Integral</label>
            <label><input type="radio" name="pao" value="sovado"> sovado</label>
        </fieldset>

        <fieldset>
            <legend>Escolha 1 Embutido/Frio</legend>
            <label><input type="radio" name="frio" value="presunto" required> Presunto</label>
            <label><input type="radio" name="frio" value="peito defumado"> peito defumado</label>
            <label><input type="radio" name="frio" value="salame colonial"> salame colonial</label>
        </fieldset>

         <fieldset>
            <legend>Escolha 1 Embutidos/Queijos</legend>
            <label><input type="radio" name="frios" value="queijo prato" required> queijo prato</label>
            <label><input type="radio" name="frios" value="Queijo mussarela"> Queijo mussarela</label>
            <label><input type="radio" name="frios" value="queijo colonial"> queijo colonial</label>
        </fieldset>


            <fieldset>
            <legend>Escolha at√© 2 Frutas</legend>
            <label><input type="checkbox" name="fruta" value="mamao" class="fruta-check"> Mam√£o</label>
            <label><input type="checkbox" name="fruta" value="banana" class="fruta-check"> Banana</label>
            <label><input type="checkbox" name="fruta" value="melancia" class="fruta-check"> Melancia</label>
            <label><input type="checkbox" name="fruta" value="uva" class="fruta-check"> Uva</label>
            <label><input type="checkbox" name="fruta" value="maca" class="fruta-check"> Ma√ß√£</label>
        </fieldset>
      
         <fieldset>
            <legend>Escolha at√© 1 sabor de cookies</legend>
            <label><input type="radio" name="cookies" value="tradicional" class="cookies-check"> tradicional</label>
            <label><input type="radio" name="cookies" value="red velvet" class="cookies-check"> red velvet</label>
              <label><input type="radio" name="cookies" value="nutella" class="cookies-check">nutella</label>
            <label><input type="radio" name="cookies" value="leite ninho" class="cookies-check">leite ninho</label>
            <label><input type="radio" name="cookies" value="amedoin" class="cookies-check"> amedoin</label>
        </fieldset>


        <button type="button" id="btnEnviar" onclick="enviarPedido()">Fazer Pedido</button>
    </form>
</div>

<script>
    // --- L√≥gica das frutas (M√°ximo 2) ---
    const checkboxes = document.querySelectorAll('.fruta-check');
    const maxFrutas = 2;

    checkboxes.forEach(check => {
        check.addEventListener('change', function() {
            const selecionados = document.querySelectorAll('.fruta-check:checked');
            if (selecionados.length >= maxFrutas) {
                checkboxes.forEach(box => {
                    if (!box.checked) {
                        box.disabled = true;
                        box.parentElement.classList.add('disabled');
                    }
                });
            } else {
                checkboxes.forEach(box => {
                    box.disabled = false;
                    box.parentElement.classList.remove('disabled');
                });
            }
        });
    });

    // --- L√≥gica de Envio ---
    function enviarPedido() {
        const form = document.getElementById('breakfastForm');
        const btn = document.getElementById('btnEnviar');
        const nome = document.getElementById('nomeCliente').value;

        // Valida√ß√£o
        if (!form.checkValidity()) {
            form.reportValidity();
            return;
        }

        // Feedback visual
        btn.textContent = "Enviando...";
        btn.classList.add("loading");
        btn.disabled = true;

        const data = new FormData(form);

        // ======================================================================
        // üëáüëáüëá COLE O LINK DO SHEETMONKEY AQUI EMBAIXO üëáüëáüëá
        // ======================================================================
        
        const SHEET_URL = "https://api.sheetmonkey.io/form/fn1n3fA5kQYTtb5GqRexyY"

        // ======================================================================

        fetch(SHEET_URL, {
            method: 'POST',
            body: data,
        })
        .then(response => {
            alert("Sucesso, " + nome + "! Seu pedido j√° est√° na nossa planilha.");
            form.reset(); // Limpa o formul√°rio
            
            // Reseta as frutas
            checkboxes.forEach(box => {
                box.disabled = false;
                box.parentElement.classList.remove('disabled');
            });
        })
        .catch(error => {
            alert("Erro! Verifique o link no c√≥digo.");
            console.error('Erro:', error);
        })
        .finally(() => {
            btn.textContent = "Fazer Pedido";
            btn.classList.remove("loading");
            btn.disabled = false;
        });
    }

    function limparPedidosAntigos() {
  var nomeDaAba = "P√°gina1"; // Se sua aba tiver outro nome, mude aqui
  var diasParaManter = 15;   // Mant√©m os √∫ltimos 15 dias
  
  var sheet = SpreadsheetApp.getActiveSpreadsheet().getSheetByName(nomeDaAba);
  
  // Verifica se a aba existe para n√£o dar erro
  if (!sheet) {
    Logger.log("Aba n√£o encontrada: " + nomeDaAba);
    return;
  }

  var data = sheet.getDataRange().getValues();
  var hoje = new Date();
  
  // Come√ßa a verificar da √∫ltima linha para cima (para n√£o pular linhas ao deletar)
  // O "i >= 1" garante que ele pare antes de apagar o Cabe√ßalho (linha 0)
  for (var i = data.length - 1; i >= 1; i--) {
    
    // O n√∫mero [1] representa a Coluna B (Data). 
    // Se a data estiver na Coluna C, mude para [2], etc.
    var dataPedido = new Date(data[i][1]); 
    
    // Se n√£o tiver data v√°lida, ignora
    if (!dataPedido || isNaN(dataPedido.getTime())) continue;

    // Calcula a diferen√ßa em dias
    var diferencaTempo = hoje - dataPedido;
    var diferencaDias = Math.floor(diferencaTempo / (1000 * 60 * 60 * 24));

    // Se for mais velho que 15 dias, deleta
    if (diferencaDias > diasParaManter) {
      sheet.deleteRow(i + 1); 
    }
  }
}
</script>

</body>
</html>